<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <link rel="stylesheet" href="../static/css/style.css">
    <link rel="stylesheet" href="../static/css/style2.css">
    <link rel="stylesheet" href="../static/css/ChonRap_style.css">
</head>

<body>
    <div class="hd_chonrap">
        <div class="hd_chonrap_top">
            <div class="container">
                <div class="hd_chonrap_top_components">
                    <a class="main_logo_link" href="#"> <!--Thay href-->
                        <img src="../static/assets/logo.jpg">
                    </a>
                    <div class="hd_left_action">
                        <a button class="btn book_btn" href="#"> <!--Thay href-->
                            <img src="https://cinestar.com.vn/assets/images/ic-ticket.svg">
                            <span class="text">Đặt vé ngay</span>
                        </a>
                    </div>
                    <div class="hd_right_action">
                        <!--Search-->
                        <div class="hd_search">
                            <div class="search_icon">
                                <img src="https://cinestar.com.vn/assets/images/icon-search.svg">
                            </div>
                            <div class="search_panel" data-name="panel_search">
                                <div class="search_panel_form">
                                    <div>
                                        <div class="search_panel_form_content">
                                            <input class="search_content" type="text"
                                                placeholder="Tìm phim, thể loại,...">
                                            <button class="search_btn" type="submit">
                                                <img src="https://cinestar.com.vn/assets/images/ic-header-search.svg">
                                            </button>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <!--Register/Login-->
                        <div class="hd_register_login">
                            <div class="hd_register_login_content">
                                <div class="hd_register_login_ava">
                                    <img src="https://cinestar.com.vn/assets/images/ic-header-auth.svg">
                                </div>
                                <div class="hd_register_login_list">
                                    <a class="link" href="#">
                                        <i class="login"></i>Đăng nhập
                                    </a>
                                    <span class="separate">/</span>
                                    <a class="link" href="#">
                                        <i class="register"></i>Đăng kí
                                    </a>
                                </div>
                            </div>
                        </div>
                        <!--Language-->
                        <div class="hd_language">
                            <div class="hd_language_action">
                                <div class="hd_language_popup">
                                    <div class="hd_language_option">
                                        <span class="image">
                                            <img src="https://cinestar.com.vn/assets/images/footer-vietnam.svg">
                                        </span>
                                        <span class="text">
                                            VN
                                        </span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="hd_chonrap_mid">
            <div class="container">
                <div class="hd_chonrap_mid_components">
                    <a class="local" href="#"> <!--Thay href-->
                        <span class="text_chonrap">Chọn rạp</span>
                    </a>
                    <div class="other">
                        <a class="link" href="#">Khuyến mãi</a>
                        <a class="link" href="#">Giới thiệu</a>
                        <a class="link" href="#">Dịch vụ khác</a>
                        <a class="link" href="#">Thuê sự kiện</a>
                    </div>


                </div>
            </div>
            <!-- <div id="wrapper">
                <div id="main_content">
                    <div id="img_content">
                        <img src="../static/assets/godzilla-vs-kong-poster.jpg" alt="" width="1400">
                    </div>
                    <div id="movie_content">
                        <h1>GODZILLA X KONG: ĐẾ CHẾ MỚI 2D (K)</h1>
                        <p style="display: flex; line-height: 2;"><img src="../static/assets/icon-tag.svg" alt=""> Khoa
                            Học Viễn Tưởng</p>
                        <p style="display: flex;line-height: 2;"><img src="../static/assets/icon-clock.svg" alt=""> 125'
                        </p>
                        <h2 style="line-height: 2;">MÔ TẢ</h2>
                        <p style="line-height: 2;">Đạo diễn: Adam Wingard</p>
                        <p style="line-height: 2;">Diễn viên: Rebecca Hall, Dan Stevens, Rachel House</p>
                        <p style="line-height: 2;">Khởi chiếu: 27/03/2024</p>
                        <h3 style="line-height: 2;">NỘI DUNG PHIM</h3>
                        <p style="line-height: 2;">Kong và Godzilla - hai sinh vật vĩ đại huyền thoại, hai kẻ thủ truyền
                            kiếp sẽ cùng bắt tay thực thi một sứ mệnh chung mang tính sống còn để bảo vệ nhân loại, và
                            trận chiến gắn kết chúng với loài người mãi mãi sẽ bắt đầu.</p>
                        <p style="display: flex; line-height: 2;text-decoration: underline;"><img
                                src="../static/assets/icons8-play-64.png" alt="" width="30"> Xem Trailer</p>
                    </div>
                </div>
            </div> -->
            <div id="wrapper">
                <div id="main_content">
                    <div id="img_content">
                        <img src="{{ movie.url_poster }}" alt="{{ movie.ten_phim }}">
                    </div>
                    <div id="movie_content">
                        <div id="tenphim">
                            <h1>{{ movie.ten_phim }}</h1>
                        </div>
                        <p style="display: flex; line-height: 2;"><img src="../static/assets/icon-tag.svg" alt=""> {{
                            movie.the_loai }}</p>
                        <p style="display: flex;line-height: 2;"><img src="../static/assets/icon-clock.svg" alt=""> {{
                            movie.thoi_luong }}'</p>
                        <h2 style="line-height: 2;">MÔ TẢ</h2>
                        <p style="line-height: 2;">Đạo diễn: {{ movie.dao_dien }}</p>
                        <p style="line-height: 2;">Diễn viên: {{ movie.dien_vien }}</p>
                        <p style="line-height: 2;">Khởi chiếu: {{ movie.ngay_khoi_chieu }}</p>
                        <h3 style="line-height: 2;">NỘI DUNG PHIM</h3>
                        <p style="line-height: 2;">{{ movie.noi_dung }}</p>
                        <p id="xem_trailer" style="display: flex; line-height: 2;text-decoration: underline;">
                            <a href="{{ movie.trailer }}" target="_blank">
                                <img src="../static/assets/icons8-play-64.png" alt="" width="30"> Xem Trailer
                            </a>
                        </p>
                    </div>
                </div>
            </div>
            <div id="movie_date" class="lichchieu">
            </div>
            <div class="btn_datve">
                <a class="btn book_btn" href="#"> <!--Thay href-->
                    <img src="https://cinestar.com.vn/assets/images/ic-ticket.svg">
                    <span class="text">Đặt vé ngay</span>
                </a>
            </div>
            <div class="select_seat">
                <h1>Chọn Suất Chiếu</h1>
                <div id="showtimes-container"></div>

                <h1>Chọn Ghế</h1>
                <div id="seats-container"></div>
            </div>
            <script>
                const movieId = 1; // Thay bằng ID phim thực tế
                let selectedShowtimeButton = null; // Biến để theo dõi nút suất chiếu được chọn

                // Hàm gọi AJAX để lấy danh sách suất chiếu
                function loadShowtimes(movieId) {
                    fetch(`/api/get_showtimes/${movieId}`)
                        .then(response => response.json())
                        .then(data => {
                            const showtimesContainer = document.getElementById('showtimes-container');
                            showtimesContainer.innerHTML = ''; // Xóa nội dung cũ
                            data.forEach(showtime => {
                                const button = document.createElement('button');
                                button.className = 'showtime-button';
                                button.textContent = `Suất chiếu lúc: ${showtime.gio_bat_dau} - Ngày: ${showtime.ngay_chieu}`;
                                button.onclick = () => selectShowtime(button, showtime.id_cachieu);
                                showtimesContainer.appendChild(button);
                            });
                        })
                        .catch(error => console.error('Error:', error));
                }


                // Hàm gọi AJAX để lấy danh sách ghế
                function loadSeats(showtimeId) {
                    fetch(`/api/get_seats/${showtimeId}`)
                        .then(response => response.json())
                        .then(data => {
                            const seatsContainer = document.getElementById('seats-container');
                            seatsContainer.innerHTML = ''; // Xóa nội dung cũ
                            data.sort((a, b) => {
                                if (a.hang < b.hang) return -1;
                                if (a.hang > b.hang) return 1;
                                return a.so - b.so;
                            });
                            data.forEach(seat => {
                                const seatDiv = document.createElement('div');
                                seatDiv.className = 'seat ' + (seat.trang_thai ? 'booked' : 'available');
                                if (seat.hang === 'E') {
                                    seatDiv.classList.add('double-seat'); // Thêm lớp double-seat cho hàng ghế E
                                }
                                seatDiv.textContent = seat.hang + seat.cot;
                                if (!seat.trang_thai) { // Chỉ thêm sự kiện click cho ghế chưa đặt
                                    seatDiv.onclick = () => toggleSeatSelection(seatDiv);
                                }
                                seatsContainer.appendChild(seatDiv);
                            });
                        })
                        .catch(error => console.error('Error:', error));
                }
                // Hàm để chọn suất chiếu
                function selectShowtime(button, showtimeId) {
                    if (selectedShowtimeButton) {
                        selectedShowtimeButton.classList.remove('selected');
                    }
                    button.classList.add('selected');
                    selectedShowtimeButton = button;
                    loadSeats(showtimeId);
                }
                // Hàm chọn/bỏ chọn ghế
                function toggleSeatSelection(seatDiv) {
                    seatDiv.classList.toggle('selected');
                }

                // Gọi hàm loadShowtimes với ID của phim
                loadShowtimes(movieId);
            </script>
            <div class="footer">
                <div>
                    <div class="container">
                        <div class="footer_components">
                            <div class="footer_list">
                                <!--Logo_Footer-->
                                <div class="footer_list-item col col4">
                                    <a class="main_logo_link_footer" href="#"> <!--Thay href-->
                                        <img src="../static/assets/logo4-2.png" width="800px" height="800px">
                                    </a>
                                </div>
                                <!--Column 1+2-->
                                <div class="footer_list-item sp">

                                    <div class="footer_list-item_top row">

                                        <div class="part">
                                            <div class="text">TÀI KHOẢN</div>
                                            <ul class="menu-list">
                                                <li class="menu-item">
                                                    <a class="menu-link" href="#">Đăng nhập</a> <!--Thay href-->
                                                </li>
                                                <li class="menu-item">
                                                    <a class="menu-link" href="#">Đăng ký</a> <!--Thay href-->
                                                </li>
                                            </ul>
                                        </div>

                                        <div class="part">
                                            <div class="text">THUÊ SỰ KIỆN</div>
                                            <ul class="menu-list">
                                                <li class="menu-item">
                                                    <a class="menu-link" href="#">Thuê rạp</a> <!--Thay href-->
                                                </li>
                                            </ul>
                                        </div>

                                    </div>

                                    <div class="footer_list-item_bottom row">

                                        <div class="part">
                                            <div class="text">XEM PHIM</div>
                                            <ul class="menu-list">
                                                <li class="menu-item">
                                                    <a class="menu-link" href="#">Phim đang chiếu</a> <!--Thay href-->
                                                </li>
                                                <li class="menu-item">
                                                    <a class="menu-link" href="#">Phim sắp chiếu</a> <!--Thay href-->
                                                </li>
                                            </ul>
                                        </div>

                                        <div class="part">
                                            <div class="text">CINESTAR</div>
                                            <ul class="menu-list">
                                                <li class="menu-item">
                                                    <a class="menu-link" href="#">Giới thiệu</a> <!--Thay href-->
                                                </li>
                                                <li class="menu-item">
                                                    <a class="menu-link" href="#">Liên hệ</a> <!--Thay href-->
                                                </li>
                                            </ul>
                                        </div>

                                    </div>

                                </div>

                                <!--Column 3-->
                                <div class="footer_list-item aform">
                                    <div class="text">DỊCH VỤ KHÁC</div>
                                    <ul class="menu-list">
                                        <li class="menu-item">
                                            <a class="menu-link" href="#">Đặt đồ ăn</a> <!--Thay href-->
                                        </li>
                                        <li class="menu-item">
                                            <a class="menu-link" href="#">Coffee</a> <!--Thay href-->
                                        </li>
                                        <li class="menu-item">
                                            <a class="menu-link" href="#">Nhà hàng</a> <!--Thay href-->
                                        </li>
                                        <li class="menu-item">
                                            <a class="menu-link" href="#">Kidzone</a> <!--Thay href-->
                                        </li>
                                        <li class="menu-item">
                                            <a class="menu-link" href="#">Gym</a> <!--Thay href-->
                                        </li>
                                        <li class="menu-item">
                                            <a class="menu-link" href="#">Nhà hát Opera</a> <!--Thay href-->
                                        </li>
                                    </ul>
                                </div>

                                <!--Column 4-->
                                <div class="footer_list-item aform">
                                    <div class="text">HỆ THỐNG RẠP</div>
                                    <ul class="menu-list">
                                        <li class="menu-item">
                                            <a class="menu-link" href="#">Tất cả hệ thống rạp</a> <!--Thay href-->
                                        </li>
                                        <li class="menu-item">
                                            <a class="menu-link" href="#">CI9MA Nguyễn Trãi</a> <!--Thay href-->
                                        </li>
                                        <li class="menu-item">
                                            <a class="menu-link" href="#">CI9MA Hai Bà Trưng</a> <!--Thay href-->
                                        </li>
                                        <li class="menu-item">
                                            <a class="menu-link" href="#">CI9MA Bình Dương</a> <!--Thay href-->
                                        </li>
                                        <li class="menu-item">
                                            <a class="menu-link" href="#">CI9MA Kiên Giang</a> <!--Thay href-->
                                        </li>
                                        <li class="menu-item">
                                            <a class="menu-link" href="#">CI9MA Đà Lạt</a> <!--Thay href-->
                                        </li>
                                        <li class="menu-item">
                                            <a class="menu-link" href="#">CI9MA Huế</a> <!--Thay href-->
                                        </li>
                                    </ul>
                                </div>

                            </div>
                        </div>

                    </div>
                    <script src="../static/js/test.js"></script>
                    </footer>
</body>

</html>